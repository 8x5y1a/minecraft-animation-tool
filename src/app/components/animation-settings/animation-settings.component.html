<div class="animation-tabs-wrapper">
  <mat-tab-group [selectedIndex]="tabIndex()">
    @for (properties of animationPropertiesList; track properties; let index =
    $index){
    <mat-tab [label]="'Animation ' + (index + 1)">
      <mat-radio-group
        class=""
        [formControl]="properties.command"
        aria-label="Select an option"
      >
        <mat-radio-button value="set">Set block</mat-radio-button>
        <mat-radio-button value="display">Display block</mat-radio-button>
        <mat-radio-button value="destroy">Destroy block</mat-radio-button>
      </mat-radio-group>
      <div class="content">
        @if(properties.command.value === 'destroy'){
        <mat-form-field>
          <mat-label>Animation to destroy</mat-label>
          <mat-select [formControl]="properties.removeAnimation">
            @for (animation of animationPropertiesList; track animation) {
            @if(animation.command.value !== 'destroy'){
            <mat-option [value]="animation">{{ animation.name }}</mat-option>
            } }
          </mat-select>
        </mat-form-field>
        } @else{
        <h4>Coordinates</h4>
        <div
          class="coordinates"
          matTooltip="Coordinates which the building will be built"
        >
          <mat-form-field>
            <mat-label>X</mat-label>
            <input type="number" matInput [formControl]="properties.x" />
          </mat-form-field>
          <mat-form-field>
            <mat-label>Y</mat-label>
            <input type="number" matInput [formControl]="properties.y" />
          </mat-form-field>
          <mat-form-field>
            <mat-label>Z</mat-label>
            <input type="number" matInput [formControl]="properties.z" />
          </mat-form-field>
        </div>
        }

        <p>
          <mat-slide-toggle
            [formControl]="properties.timing"
            matTooltip="When on: the build will animate in gradually | When off: it appears instantly"
          >
            Animation
          </mat-slide-toggle>
        </p>

        @if(properties.timing.value){
        <h4>Animation settings</h4>
        <div class="center" style="display: flex">
          <mat-card-content>
            <mat-form-field>
              <mat-label>Animation speed</mat-label>
              <input
                matInput
                matTooltip="Higher value is slower"
                type="number"
                [min]="1"
                [max]="500"
                [formControl]="properties.speed"
              />
            </mat-form-field>
          </mat-card-content>

          <mat-form-field>
            <mat-label>Animation order</mat-label>
            <mat-select [formControl]="properties.animationOrder">
              <mat-option value="x">X</mat-option>
              <mat-option value="y">Y</mat-option>
              <mat-option value="z">Z</mat-option>
              <mat-option value="random">Random</mat-option>
            </mat-select>
          </mat-form-field>

          <mat-slide-toggle
            [formControl]="properties.isAscending"
            matTooltip="Should it Start from the smallest value and end with the highest value"
          >
            Ascending order
          </mat-slide-toggle>

          <div matTooltip="Add a level of randomness to the current animation order. (0: No randomness)">
            <div class="randomness-label-container">
              <label for="slider">Randomness: </label>
              <label for="slider"> {{ properties.randomness.value }}</label>
            </div>
            <mat-slider [max]="10" [min]="0" [step]="1">
              <input
                [formControl]="properties.randomness"
                matSliderThumb
                id="slider"
              />
            </mat-slider>
          </div>
        </div>
        } @if(properties.command.value === 'display'){
        <div>
          <mat-form-field>
            <input
              matInput
              type="number"
              [formControl]="properties.scale"
              placeholder="Enter something"
              min="0.001"
            />
            <mat-label>Scaling</mat-label>
          </mat-form-field>
        </div>
        }
      </div>
      <!-- TODO: Footer style -->
      <div class="footer">
        @if(properties.command.value !== 'destroy'){
        <button
          mat-button
          matTooltip="Add a destroy animation for this animation"
          (click)="addDestroyAnimation(properties)"
        >
          Add destroy for this animation
        </button>
        } @if(animationPropertiesList.length > 1){
        <button
          mat-button
          matTooltip="Remove this animation"
          (click)="removeAnimation(index)"
        >
          Remove
        </button>
        }
      </div>
    </mat-tab>
    }
  </mat-tab-group>
  <button
    mat-flat-button
    matTooltip="Add another animation"
    class="add-animation-btn"
    (click)="addAnimation()"
  >
    <mat-icon style="margin: 0">add</mat-icon>
  </button>
</div>
